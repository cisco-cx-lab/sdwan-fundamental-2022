<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Day 1 Tasks - sdwan-fundamental-2022</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Day 1 Tasks";
    var mkdocs_page_input_path = "day1.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> sdwan-fundamental-2022</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Lab Guide</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../intro/">Introduction</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Day 1 Tasks</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#31-day-1-tasks">3.1. Day 1 tasks</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../day2/">Day 2 Tasks</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../survey/">Survey</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">sdwan-fundamental-2022</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Lab Guide &raquo;</li>
        
      
    
    <li>Day 1 Tasks</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h2 id="3-lab-tasks">3. Lab Tasks</h2>
<h3 id="31-day-1-tasks"><strong>3.1. Day 1 tasks</strong></h3>
<p>In Day 1's lab, attendee will learn how to onboard virtual Edge router CSR1kv into the SDWAN fabric, and how to create device template using feature template for basic SDWAN features.</p>
<p>Similar to real world scenario, for SDWAN deployment, the first step is to install controllers. It is common to use Cisco hosted controller. The Cisco CloudOps team will take care of the controller design and installation. Attendee can reference the Cisco SD-WAN CloudOps document for detail information.
</p>
<a href="https://www.cisco.com/c/en/us/td/docs/routers/sdwan/knowledge-base/CloudOps/b-cisco-sdwan-cloudops.html">https://www.cisco.com/c/en/us/td/docs/routers/sdwan/knowledge-base/CloudOps/b-cisco-sdwan-cloudops.html</a>
</p>
Another controller deployment model is on-premise controller. Attendee can reference the SDWAN getting started guide for controller installation.
</p>
<a href="https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/sdwan-xe-gs-book/cisco-sd-wan-overlay-network-bringup.html">https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/sdwan-xe-gs-book/cisco-sd-wan-overlay-network-bringup.html</a>
</p>
In this lab, all SDWAN controllers including vManage, vSmart and vBond are pre-configured for each pod.</p>
<p>After controllers are up, the next step is to bring up the headend or datacenter. The headend or datacenter will function as transit site between SDWAN and non SDWAN site. In this lab, DC WAN Edges are pre-configured and onboarded to SDWAN fabric. Attendee needs to review the SDWAN basic template configuration and verify connectivity. To make the DC as transit site between SDWAN and non SDWAN, attendee needs to configure the WAN Edge router to establish OSPF neighbor with DC Router and redistribute the OSPF learned routes into OMP.</p>
<hr />
<ul>
<li>
<p>3.1.1. <strong>Verify DC connectivity</strong>
In this task, attendee will verify reachability from DC to remote site1 and site2.
Reference <strong>Device access</strong> table for login IP and credential. </P></p>
</li>
<li>
<p><strong>Step1</strong> SSH into <strong>DC1-WAN-Agg</strong> and verify it has BGP neighbor with the MPLS PE, and also learns other site prefixes over BGP.
Run <code>show ip bgp summary</code>
</br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_1_a.png" width="800"/>
</br></br></p>
</li>
</ul>
<p>Run <code>show ip route bgp</code>
</br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_1_b.png" width="800"/>
</br></br>
  - <strong>Step2</strong> Verify reachability to <strong>dc1-cedge1</strong> and <strong>dc1-cedge2</strong>
Run <code>ping 10.10.11.1</code> and <code>ping 10.10.12.1</code>
</br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_1_c.png" width="800"/>
</br></br>
  - <strong>Step3</strong> Verify reachability to <strong>Site1-VM1</strong> and <strong>site2-VM1</strong>
Run <code>ping 10.200.100.100</code>, <code>ping 10.30.100.100</code>
</br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_1_d.png" width="800"/>
</br></br></p>
<ul>
<li>3.1.2. <strong>vManage walk through</strong></li>
</ul>
<p>In this task, attendee will walk through the vManage GUI.</p>
<ul>
<li>
<p><strong>Step1</strong> Login vManage from <strong><a href="https://198.18.133.200:8443">https://198.18.133.200:8443</a></strong>
</p>
<strong>Note</strong> Please ignore the self sign cert warning and proceed.
Login to vManage using <strong>admin/pocadmin</strong> for username/password, then click <strong>Log In</strong>.
</br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_a.png" width="800"/>
</br></br></p>
</li>
<li>
<p><strong>Step2</strong> On the main dashboard, verify the <strong>SUMMARY</strong> panel for quick overview of the fabric inventory; verify <strong>Control Status</strong> for overview of control channels.
  </br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_b.png" width="800"/>
  </br></br></p>
</li>
<li>
<p><strong>Step3</strong> Navigate to the panel on the left and click <strong>Monitor - Network</strong> for detail information of each device in the fabric.
  </br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_c.png" width="800"/>
  </br></br></p>
</li>
<li>
<p><strong>Step4</strong> click device name <strong>dc1-cedge1</strong> to access the device specific information.
  This is main page to verify device information, statistics, and troubleshooting options. Explore the page and get familiar with navigation panel on the left such as supported troubleshooting capability, commands available from Real Time.</p>
</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_d.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step5</strong> Navigate to the panel on the left and click <strong>Configuration - Certificates</strong> for the WAN Edge and Controllers certificate status.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_e.png" width="800"/>
  </br></br></p>
<p>On the <strong>WAN Edge List</strong> certificate page, pay attention to the state of the certificate, chassis number as well as Serial No/Token. Attendee will use information on this page to onboard virtual WAN Edge in this lab.</p>
<p></br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_f.png" width="800"/>
</br></br></p>
<ul>
<li><strong>Step6</strong> Navigate to the panel on the left and click <strong>Tools - SSH Terminal</strong> for the build in device access tool.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_2_g.png" width="800"/>
  </br></br></p>
<p>Feel free to explore other operations on vManage portal.</p>
<ul>
<li>
<p>3.1.3. <strong>Review DC Edge Device Templates</strong>
In this task, attendee will review the pre-configured device templates for <strong>dc1-cedge1</strong> and <strong>dc1-cedge2</strong>.</p>
</li>
<li>
<p><strong>Step1</strong> Navigate to the panel on the left and click <strong>Configuration - Templates</strong> for the device and feature template.</p>
</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_3_a.png" width="800"/>
  </br></br></p>
<ul>
<li>Attendee should see two prebuilt device templates as shown in the screenshot above.</li>
<li><strong>Step2</strong> Locate one of the device template and click the <strong>'...'</strong> on the right and select <strong>Edit</strong> to view the template configuration</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_3_b.png" width="800"/>
 </br></br></p>
<ul>
<li>This will list all <strong>feature templates</strong> associated to the device template. You can click each feature template and select <strong>View Template</strong> to view the configuration of the feature template.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_3_c.png" width="800"/>
  </br></br></p>
<p>A device template consists of few sections, each section has it own set of feature templates. The mandatory feature templates are marked as <strong>'*'</strong>.</p>
<ul>
<li>3.1.4. <strong>Add OSPF to DC Device Template</strong></li>
</ul>
<p>In this section, attendee will modify the pre-configured device template and add OSPF as routing protocol for service side VPN. After configuring OSPF, attendee will verify OSPF neighbor with dc-wan-agg router.</p>
<ul>
<li><strong>Step1</strong> Navigate to the panel on the left and click <strong>Configuration - Templates</strong>, then click <strong>Feature</strong> tab on the top to switch to the feature template configuration.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_a.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step2</strong> Click <strong>Add Template</strong>, find and select <strong>CSR 1000v</strong> under <strong>select Devices</strong></li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_b.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step3</strong> Find and select <strong>Cisco OSPF</strong> template on the right</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_c.png" width="800"/>
  </br></br></p>
<ul>
<li>
<p><strong>Step4</strong> Create OSPF template with following name and description. Leave <strong>BASIC CONFIGURATION</strong> as the default.   </p>
<ul>
<li><strong>Template Name</strong>|<strong>CX-VPN1-OSPF-V01</strong>|</li>
<li><strong>Description</strong>|<strong>CX-VPN1-OSPF-V01</strong>|</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_d.png" width="800"/>
  </br></br></p>
</li>
<li>
<p>Click <strong>New Redistribute</strong> under REDISTRIBUTE section, select <strong>omp</strong> from protocol drop down list then click <strong>Add</strong>
<strong>Note</strong> In the lab, we will not add Route Policy, but in production deployment it's good practice to use route policy to tag routes being redistributed from OMP into OSPF</p>
</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_e.png" width="800"/>
 </br></br></p>
<ul>
<li>Click <strong>New Area</strong> under AREA section, enter <strong>100</strong> in <strong>Area Number</strong>, click <strong>+ Add Interface</strong> to add interface that participants in OSPF process</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_f.png" width="800"/>
 </br></br></p>
<ul>
<li>Click <strong>Add Interface</strong> from the popup window for Interface configuration</li>
<li>Click the drop down for <strong>Interface Name</strong>, move your mouse to <strong>Device Specific</strong>,  enter <strong>VPN1_OSPF_INT</strong> as variable for OSPF Interface Name</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_g.png" width="800"/>
 </br></br></p>
<ul>
<li>Explore other OSPF configuration options but for lab leave other filed as default and click <strong>Add</strong> to add the interface variable for OSPF area 0.</li>
<li>Click <strong>Add</strong> to add OSPF Area config</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_h.png" width="800"/>
  </br></br></p>
<ul>
<li>Leave other field as default and click <strong>Save</strong> to finish configuring OSPF feature template</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_i.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step5</strong> Click <strong>Device</strong> on the top to switch to device template. Locate one of the device template and click the <strong>'...'</strong> on the right and select <strong>Edit</strong> to add new OSPF template to pre-configured DC device template.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_j.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step6</strong> Move to <strong>Service VPN</strong> section, highlight the template of <strong>VPN_1</strong> click the <strong>...</strong> and select <strong>Edit</strong></li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_k.png" width="800"/>
 </br></br></p>
<ul>
<li><strong>Step7</strong> Select <strong>Cisco OSPF</strong> from the <strong>Additional Cisco VPN Templates</strong> panel on the right. Select <strong>CX-VPN1-OSPF-V01</strong> from the drop down list for Cisco OSPF template.</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_l.png" width="800"/>
  </br></br></p>
<ul>
<li>
<p><strong>Step8</strong> Click <strong>Save</strong> to return back to device template and click <strong>Update</strong> to update the device template.</p>
<p></br></br>
<img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_m.png" width="800"/>
</br></br></p>
</li>
</ul>
<p><strong>Note</strong> Changing device template will trigger configuration update for device attached to the device template. In production network, it is common practice to replicate the existing device template, modify on the new device template then associate device to the new device template.</p>
<ul>
<li><strong>Step9</strong> Click the <strong>...</strong> to update device configuration. Enter <strong>GigabitEthernet3</strong> in the field for new variable you just created in OSPF teamplte.</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_n.png" width="800"/>
 </br></br></p>
<ul>
<li>
<p><strong>Step10</strong> Click <strong>Update</strong> to save the change, and click <strong>Next</strong> to the configuration preview</p>
</li>
<li>
<p><strong>Step11</strong> click the device name on the left panel, then click <strong>Config Diff</strong> to do a configuration <strong>Side by Side</strong> comparison</p>
</li>
</ul>
<p></br></br>
 <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_4_o.png" width="800"/>
 </br></br></p>
<ul>
<li>
<p><strong>Step12</strong> After reviewing the new configuration change, click <strong>Configure Devices</strong> to push the configuration.</p>
</li>
<li>
<p><strong>Step13</strong> Wait for the configuration push is successfully finished. <strong>Repeat the same above steps to add OSPF on the other pre-configured DC device template.</strong></p>
</li>
<li>
<p><strong>Step14</strong> Login to <strong>dc1-wan-agg</strong>, and run <code>show ip ospf neighbor</code></p>
</li>
</ul>
<pre><code> DC1-WANAgg#show ip ospf neighbor

Neighbor ID     Pri   State           Dead Time   Address         Interface
10.10.12.1        1   FULL/BDR        00:00:33    10.10.12.1      GigabitEthernet2
10.10.11.1        1   FULL/BDR        00:00:32    10.10.11.1      GigabitEthernet1
DC1-WANAgg#
</code></pre>
<ul>
<li>login to <strong>dc1-cedge1</strong> and run <code>show ip route vrf 1</code></li>
</ul>
<pre><code>dc1-cedge1#show ip route vrf 1

Routing Table: 1
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2, m - OMP
       n - NAT, Ni - NAT inside, No - NAT outside, Nd - NAT DIA
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       H - NHRP, G - NHRP registered, g - NHRP registration summary
       o - ODR, P - periodic downloaded static route, l - LISP
       a - application route
       + - replicated route, % - next hop override, p - overrides from PfR
       &amp; - replicated local route overrides by connected

Gateway of last resort is not set

      10.0.0.0/8 is variably subnetted, 9 subnets, 2 masks
O E2     10.1.11.0/24 [110/1] via 10.10.11.2, 07:48:43, GigabitEthernet3
O E2     10.1.12.0/24 [110/1] via 10.10.11.2, 07:48:43, GigabitEthernet3
C        10.10.11.0/24 is directly connected, GigabitEthernet3
L        10.10.11.1/32 is directly connected, GigabitEthernet3
O        10.10.12.0/24 [110/2] via 10.10.11.2, 07:48:43, GigabitEthernet3
O        10.10.100.0/24 [110/2] via 10.10.11.2, 07:48:43, GigabitEthernet3
O E2     10.30.100.0/24 [110/1] via 10.10.11.2, 07:48:43, GigabitEthernet3
O E2     10.200.100.0/24 [110/1] via 10.10.11.2, 07:48:43, GigabitEthernet3
O E2     10.200.200.0/24 [110/1] via 10.10.11.2, 07:48:43, GigabitEthernet3

</code></pre>
<ul>
<li>login to <strong>dc1-cedge2</strong> and run <code>show ip route vrf 1</code></li>
</ul>
<pre><code>dc1-cedge2#show ip route vrf 1

Routing Table: 1
Codes: L - local, C - connected, S - static, R - RIP, M - mobile, B - BGP
       D - EIGRP, EX - EIGRP external, O - OSPF, IA - OSPF inter area
       N1 - OSPF NSSA external type 1, N2 - OSPF NSSA external type 2
       E1 - OSPF external type 1, E2 - OSPF external type 2, m - OMP
       n - NAT, Ni - NAT inside, No - NAT outside, Nd - NAT DIA
       i - IS-IS, su - IS-IS summary, L1 - IS-IS level-1, L2 - IS-IS level-2
       ia - IS-IS inter area, * - candidate default, U - per-user static route
       H - NHRP, G - NHRP registered, g - NHRP registration summary
       o - ODR, P - periodic downloaded static route, l - LISP
       a - application route
       + - replicated route, % - next hop override, p - overrides from PfR
       &amp; - replicated local route overrides by connected

Gateway of last resort is not set

      10.0.0.0/8 is variably subnetted, 9 subnets, 2 masks
O E2     10.1.11.0/24 [110/1] via 10.10.12.2, 07:53:41, GigabitEthernet3
O E2     10.1.12.0/24 [110/1] via 10.10.12.2, 07:53:41, GigabitEthernet3
O        10.10.11.0/24 [110/2] via 10.10.12.2, 07:53:41, GigabitEthernet3
C        10.10.12.0/24 is directly connected, GigabitEthernet3
L        10.10.12.1/32 is directly connected, GigabitEthernet3
O        10.10.100.0/24 [110/2] via 10.10.12.2, 07:53:41, GigabitEthernet3
O E2     10.30.100.0/24 [110/1] via 10.10.12.2, 07:53:41, GigabitEthernet3
O E2     10.200.100.0/24 [110/1] via 10.10.12.2, 07:53:41, GigabitEthernet3
O E2     10.200.200.0/24 [110/1] via 10.10.12.2, 07:53:41, GigabitEthernet3
dc1-cedge2#

</code></pre>
<p>Other site prefixes <strong>"10.30.100.0/24"</strong>,<strong>"10.200.100.0/24"</strong> and <strong>"10.200.200.0/24"</strong> are learned on edge routers.</p>
<ul>
<li>3.1.5. <strong>Verify network prefixes in fabric</strong></li>
</ul>
<p>In this task, attendee will learn how to verify OMP route in fabric, and also learn how to advertise routes into OMP.</p>
<ul>
<li><strong>Step1</strong> Login to vSmart-1 and run <code>show omp route vpn 1</code> </br></li>
</ul>
<pre><code>vSmart-1# show omp route vpn 1
Code:
C   -&gt; chosen
I   -&gt; installed
Red -&gt; redistributed
Rej -&gt; rejected
L   -&gt; looped
R   -&gt; resolved
S   -&gt; stale
Ext -&gt; extranet
Inv -&gt; invalid
Stg -&gt; staged
IA  -&gt; On-demand inactive
U   -&gt; TLOC unresolved

                                            PATH                      ATTRIBUTE
VPN    PREFIX              FROM PEER        ID     LABEL    STATUS    TYPE       TLOC IP          COLOR            ENCAP  PREFERENCE
--------------------------------------------------------------------------------------------------------------------------------------
1      10.10.11.0/24       1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     R         installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     R         installed  1.10.1.2         biz-internet     ipsec  -
1      10.10.12.0/24       1.10.1.1         66     1003     R         installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     R         installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.10.100.0/24      1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
</code></pre>
<p>You notice the other site prefixes <strong>"10.30.100.0/24"</strong>,<strong>"10.200.100.0/24"</strong> and <strong>"10.200.200.0/24"</strong> are not showing up on vSmart. In order to pass the prefixes to the fabric, attendee needs to advertise OSPF routes into OMP.</p>
<ul>
<li>
<p><strong>Step2</strong> Login vManage from <strong><a href="https://198.18.133.200:8443">https://198.18.133.200:8443</a></strong>. Navigate to the panel on the left and click <strong>Configuration - Templates</strong>, then click <strong>Feature</strong> tab on the top to switch to the feature template configuration.</p>
</li>
<li>
<p><strong>Step3</strong> search <strong>vpn_1</strong> in the search box; locate the VPN template, click <strong>...</strong> and select <strong>Edit</strong></p>
</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_5_a.png" width="800"/>
  </br></br></p>
<ul>
<li>
<p><strong>Step4</strong> Click <strong>New Advertise OMP</strong> under Advertise OMP section</p>
</li>
<li>
<p><strong>Step5</strong> Select <strong>OSPF</strong> from the Protocol drop down list and click <strong>Add</strong></p>
</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_5_b.png" width="800"/>
  </br></br></p>
<ul>
<li>
<p><strong>Step6</strong> Click <strong>Update</strong> - <strong>Next</strong> - <strong>Configure Devices</strong> to trigger the configuration push</p>
</li>
<li>
<p><strong>Step7</strong> Click the check box to confirm change on 2 devices</p>
</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_5_c.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step8</strong> Wait after the configuration push is complete successfully</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_5_d.png" width="800"/>
  </br></br></p>
<ul>
<li><strong>Step9</strong> Login to vSmart-1 and run <code>show omp route vpn 1</code></li>
</ul>
<pre><code>vSmart-1# show omp route vpn 1
Code:
C   -&gt; chosen
I   -&gt; installed
Red -&gt; redistributed
Rej -&gt; rejected
L   -&gt; looped
R   -&gt; resolved
S   -&gt; stale
Ext -&gt; extranet
Inv -&gt; invalid
Stg -&gt; staged
IA  -&gt; On-demand inactive
U   -&gt; TLOC unresolved

                                            PATH                      ATTRIBUTE
VPN    PREFIX              FROM PEER        ID     LABEL    STATUS    TYPE       TLOC IP          COLOR            ENCAP  PREFERENCE
--------------------------------------------------------------------------------------------------------------------------------------
1      10.1.11.0/24        1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.1.12.0/24        1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.10.11.0/24       1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     R         installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     R         installed  1.10.1.2         biz-internet     ipsec  -
1      10.10.12.0/24       1.10.1.1         66     1003     R         installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     R         installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.10.100.0/24      1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.30.100.0/24      1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.200.100.0/24     1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -
1      10.200.200.0/24     1.10.1.1         66     1003     C,R       installed  1.10.1.1         mpls             ipsec  -
                           1.10.1.1         68     1003     C,R       installed  1.10.1.1         biz-internet     ipsec  -
                           1.10.1.2         66     1003     C,R       installed  1.10.1.2         mpls             ipsec  -
                           1.10.1.2         68     1003     C,R       installed  1.10.1.2         biz-internet     ipsec  -

vSmart-1#
</code></pre>
<ul>
<li>3.1.6. <strong>Onboard WAN Edge in Site3</strong><br><br></li>
</ul>
<p>In this section, attendee will add new site into the fabric by onboarding edge routers of the site.</p>
<ul>
<li><strong>Step1</strong> Login vManage from <strong><a href="https://198.18.133.200:8443">https://198.18.133.200:8443</a></strong>. Navigate to the panel on the left and click <strong>Configuration - Devices</strong></li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_6_a.png" width="800"/>
  </br></br></p>
<p>The <strong>Chassis Number</strong> and <strong>Token</strong> will be used on next step</p>
<ul>
<li>
<p><strong>Step2</strong> Login to <strong>br3-ce1</strong> from SSH</p>
</li>
<li>
<p><strong>Step3</strong> In the terminal, enter <code>request platform software sdwan vedge_cloud activate chassis-number ### token ###</code> where the <strong>chassis-number</strong> and <strong>token</strong> are from <strong>Step1</strong></p>
</li>
</ul>
<p><code>request platform software sdwan vedge_cloud activate chassis-number CSR-BEAF1155-A0C4-475C-99E0-26174C522B27 token b1efccd671c341ee997f0abfa1a54ed5</code></p>
<ul>
<li><strong>Step4</strong> Verify the control plane using command <code>show sdwan control connections</code> </br></li>
</ul>
<pre><code>  br3-ce1#show sdwan control connections
                                                                                       PEER                                          PEER                                          CONTROLLER
PEER    PEER PEER            SITE       DOMAIN PEER                                    PRIV  PEER                                    PUB                                           GROUP
TYPE    PROT SYSTEM IP       ID         ID     PRIVATE IP                              PORT  PUBLIC IP                               PORT  ORGANIZATION            LOCAL COLOR     PROXY STATE UPTIME      ID
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
vsmart  dtls 1.1.1.3         1          1      19.1.1.4                                12346 19.1.1.4                                12346 Viptela-POC-Tool - 19827mpls            No    up     0:00:03:22  0
vbond   dtls 0.0.0.0         0          0      19.1.1.2                                12346 19.1.1.2                                12346 Viptela-POC-Tool - 19827mpls            -     up     0:00:03:22  0
vmanage dtls 1.1.1.1         1          0      19.1.1.3                                12446 19.1.1.3                                12446 Viptela-POC-Tool - 19827mpls            No    up     0:00:03:22  0


br3-ce1#
</code></pre>
<ul>
<li><strong>Step5</strong> Repeat the above steps to onboard <strong>br3-ce2</strong></li>
</ul>
<pre><code>be3-ce2#$ware sdwan vedge_cloud activate chassis-number CSR-71B50FB7-31E9-4720-8490-36060C2F17E4 token ed6e7f32348441b8ad41a86434592949
be3-ce2#
be3-ce2#
be3-ce2#show sdwan control connections
                                                                                       PEER                                          PEER                                          CONTROLLER
PEER    PEER PEER            SITE       DOMAIN PEER                                    PRIV  PEER                                    PUB                                           GROUP
TYPE    PROT SYSTEM IP       ID         ID     PRIVATE IP                              PORT  PUBLIC IP                               PORT  ORGANIZATION            LOCAL COLOR     PROXY STATE UPTIME      ID
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
vbond   dtls 0.0.0.0         0          0      19.1.1.2                                12346 19.1.1.2                                12346 Viptela-POC-Tool - 19827biz-internet    -     up     0:00:00:24  0
vmanage dtls 1.1.1.1         1          0      19.1.1.3                                12446 19.1.1.3                                12446 Viptela-POC-Tool - 19827biz-internet    No    up     0:00:00:24  0

</code></pre>
<ul>
<li><strong>Step6</strong> Verify the new site from vManage dashboard</li>
</ul>
<p></br></br>
  <img src="https://leitian123.github.io/sdwan-fundamental-2022/img/3_1_6_b.png" width="800"/>
  </br></br></p>
<p>Now you have successfully onboarded new site into the SDWAN fabric.</p>
<ul>
<li>3.1.7. <strong>Develop device template for Site3 CE1 and CE2</strong><br><br></li>
</ul>
<p>In this task, attendee will create one device template that fits for both br3-ce1 and br3-ce2. There are connections between br3-ce1 and br3-ce2 for tloc-ext, which will be task for Day2's lab. Attendee doesn't need to add the tloc-ext interface on the template now.</p>
<ul>
<li><strong>Step1</strong> Login to <strong>br3-ce1</strong> &amp; <strong>br3-ce2</strong> from ssh. Verify interface and IP information for br3-ce1 and br3-ce2</li>
</ul>
<pre><code>br3-ce1#show ip int b
Interface              IP-Address      OK? Method Status                Protocol
GigabitEthernet1       10.1.3.2        YES other  up                    up
GigabitEthernet2       unassigned      YES unset  up                    up
GigabitEthernet3       unassigned      YES unset  up                    up
GigabitEthernet4       unassigned      YES unset  down                  down
GigabitEthernet5       10.40.100.2     YES other  up                    up
GigabitEthernet6       10.40.200.2     YES other  up                    up
GigabitEthernet7       192.168.40.2    YES other  up                    up
GigabitEthernet8       192.168.150.12  YES other  up                    up
Sdwan-system-intf      1.1.1.5         YES unset  up                    up
Loopback65528          192.168.1.1     YES other  up                    up
NVI0                   unassigned      YES unset  up                    up
Tunnel1                10.1.3.2        YES TFTP   up                    up
br3-ce1#
</code></pre>
<pre><code>br3-ce1#show ip int b
Interface              IP-Address      OK? Method Status                Protocol
GigabitEthernet1       10.1.3.2        YES other  up                    up
GigabitEthernet2       unassigned      YES unset  up                    up
GigabitEthernet3       unassigned      YES unset  up                    up
GigabitEthernet4       unassigned      YES unset  down                  down
GigabitEthernet5       10.40.100.2     YES other  up                    up
GigabitEthernet6       10.40.200.2     YES other  up                    up
GigabitEthernet7       192.168.40.2    YES other  up                    up
GigabitEthernet8       192.168.150.12  YES other  up                    up
Sdwan-system-intf      1.1.1.5         YES unset  up                    up
Loopback65528          192.168.1.1     YES other  up                    up
NVI0                   unassigned      YES unset  up                    up
Tunnel1                10.1.3.2        YES TFTP   up                    up
br3-ce1#

</code></pre>
<ul>
<li>
<p><strong>Step2</strong> Login vManage from <strong><a href="https://198.18.133.200:8443">https://198.18.133.200:8443</a></strong>. Navigate to the panel on the left and click <strong>Configuration - Templates</strong>, then click <strong>Feature</strong> tab on the top to switch to the feature template configuration.</p>
<ul>
<li>Add the following feature templates<br />
  |Template Type|Purpose of the template|Template Name|
  |---|---|---|
  |Cisco VPN|VPN 0 FT with single static route|CX_VPN0_Static_Route_v01|
  |Cisco VPN Interface Ethernet|VPN 0 transport Interface with static IP|CX_VPN0_Transport1_v01|</li>
</ul>
</li>
</ul>
<p>Verify the IP information for br3-ce1 and br3-ce2, attendee will create</p>
<ul>
<li>3.1.8. <strong>Verify reachability from Site3 to other sites</strong><br><br></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../day2/" class="btn btn-neutral float-right" title="Day 2 Tasks">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../intro/" class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../intro/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../day2/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
